# Observability Stack Environment Configuration
# Copy this file to .env and configure with your actual values
# DO NOT commit .env to git (it's in .gitignore)

# ===================================================================
# InfluxDB Configuration
# ===================================================================
# InfluxDB URL for external access (used by LibreNMS and clients)
# Change to your Grafana VM's hostname or IP address
INFLUXDB_URL=http://grafana.example.com:8086
INFLUXDB_PORT=8086

# Initial admin user credentials
INFLUXDB_ADMIN_USER=admin
INFLUXDB_ADMIN_PASSWORD=changeme_influxdb_password

# Organization and bucket for LibreNMS data
INFLUXDB_ORG=observability
INFLUXDB_BUCKET=librenms

# Admin token (generated randomly - keep secure)
# Generate a new token with: openssl rand -base64 32
INFLUXDB_TOKEN=changeme_random_token_here_32chars_minimum

# ===================================================================
# Grafana Configuration
# ===================================================================
# Admin credentials
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=changeme_grafana_password

# Domain for Grafana (FQDN or IP)
GRAFANA_DOMAIN=localhost

# ===================================================================
# Grafana Zabbix Plugin (required)
# ===================================================================
# Enable automatic installation of Zabbix plugin
GRAFANA_INSTALL_ZABBIX_PLUGIN=true

# Zabbix plugin ID from Grafana plugin registry
# See: https://grafana.com/grafana/plugins/alexanderzobnin-zabbix-app/
GRAFANA_ZABBIX_PLUGIN_ID=alexanderzobnin-zabbix-app

# Trends threshold in days (data older than this uses trends table)
# Recommended: 7 days for optimal performance with 1-year retention
# Lower value = faster queries but larger trends table
# Higher value = more detailed history but slower queries
GRAFANA_ZABBIX_TRENDS_THRESHOLD_DAYS=7

# ===================================================================
# Zabbix Integration (API Token Authentication)
# ===================================================================
# Zabbix API URL - must point to the JSON-RPC API endpoint
# Format: http://<zabbix-host>/api_jsonrpc.php
# Examples:
#   http://zabbix.example.com/api_jsonrpc.php
#   https://zabbix.example.com/zabbix/api_jsonrpc.php
ZABBIX_URL=http://zabbix.example.com/api_jsonrpc.php

# Zabbix API Token (REQUIRED)
# API token authentication is the only supported method
# Username/password authentication is NOT supported
#
# To generate an API token:
# 1. Login to Zabbix web interface as admin
# 2. Navigate to: Administration â†’ Users
# 3. Select the user for Grafana integration (or create new user)
# 4. Go to "API tokens" tab
# 5. Click "Create API token"
# 6. Set description (e.g., "Grafana Integration")
# 7. Set expiration (optional, or leave empty for no expiration)
# 8. Copy the generated token and paste below
#
# IMPORTANT: Token must have read permissions on required host groups
ZABBIX_API_TOKEN=changeme_zabbix_api_token

# ===================================================================
# LibreNMS Integration
# ===================================================================
# Note: LibreNMS pushes metrics to InfluxDB on this VM
# Configure LibreNMS to use:
#   - URL: ${INFLUXDB_URL}
#   - Organization: ${INFLUXDB_ORG}
#   - Bucket: ${INFLUXDB_BUCKET}
#   - Token: ${INFLUXDB_TOKEN}

# Optional: LibreNMS database for direct queries (if needed)
# LIBRENMS_DB_HOST=librenms.example.com
# LIBRENMS_DB_NAME=librenms
# LIBRENMS_DB_USER=grafana_reader
# LIBRENMS_DB_PASSWORD=changeme_librenms_db_password

# ===================================================================
# Security Notes
# ===================================================================
# 1. Change ALL default passwords and tokens before deployment
# 2. Use strong, randomly generated passwords (minimum 16 characters)
# 3. Generate InfluxDB token with: openssl rand -base64 32
# 4. Generate Zabbix API token in Zabbix UI (see instructions above)
# 5. Keep this file secure (chmod 600 .env)
# 6. Never commit .env to version control
# 7. Rotate credentials and tokens regularly
# 8. Update INFLUXDB_URL to match your Grafana VM hostname/IP

# ===================================================================
# Example Strong Password Generation
# ===================================================================
# openssl rand -base64 24  # Generates a 24-character password
# pwgen -s 32 1            # Generates a 32-character secure password
