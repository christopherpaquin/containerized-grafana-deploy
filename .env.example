# Observability Stack Environment Configuration
# Copy this file to .env and configure with your actual values
# DO NOT commit .env to git (it's in .gitignore)

# ===================================================================
# InfluxDB Configuration
# ===================================================================
# Initial admin user credentials
INFLUXDB_ADMIN_USER=admin
INFLUXDB_ADMIN_PASSWORD=changeme_influxdb_password

# Organization and bucket for LibreNMS data
INFLUXDB_ORG=observability
INFLUXDB_BUCKET=librenms

# Admin token (REQUIRED - generate manually before installation)
# Generate a new token with: openssl rand -base64 32
# This token is used during InfluxDB initial setup and by Grafana for queries
INFLUXDB_TOKEN=changeme_random_token_here_32chars_minimum

# ===================================================================
# DOCUMENTATION ONLY - These variables are NOT consumed by deployment
# ===================================================================
# The following variables exist as reference documentation for configuring
# LibreNMS to push metrics to this InfluxDB instance. They are NOT used by
# any scripts, quadlets, or configuration files in this deployment.
#
# When configuring LibreNMS, use these values:
#   - URL: http://<your-grafana-vm-ip>:8086
#   - Organization: observability (from INFLUXDB_ORG above)
#   - Bucket: librenms (from INFLUXDB_BUCKET above)
#   - Token: <value from INFLUXDB_TOKEN above>
#
# Example values (update to match your environment):
INFLUXDB_URL=http://grafana.example.com:8086
INFLUXDB_PORT=8086

# ===================================================================
# Grafana Configuration
# ===================================================================
# Admin credentials
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=changeme_grafana_password

# Domain for Grafana (FQDN or IP)
GRAFANA_DOMAIN=localhost

# ===================================================================
# Grafana Zabbix Plugin
# ===================================================================
# Enable automatic installation of Zabbix plugin
# Set to 'true' to install plugin, 'false' to skip
# If enabled, GRAFANA_ZABBIX_PLUGIN_ID must also be set
GRAFANA_INSTALL_ZABBIX_PLUGIN=true

# Zabbix plugin ID from Grafana plugin registry
# See: https://grafana.com/grafana/plugins/alexanderzobnin-zabbix-app/
# Required if GRAFANA_INSTALL_ZABBIX_PLUGIN=true
GRAFANA_ZABBIX_PLUGIN_ID=alexanderzobnin-zabbix-app

# Trends threshold in days (data older than this uses trends table)
# Recommended: 7 days for optimal performance with 1-year retention
# Lower value = faster queries but larger trends table
# Higher value = more detailed history but slower queries
# Required if GRAFANA_INSTALL_ZABBIX_PLUGIN=true
GRAFANA_ZABBIX_TRENDS_THRESHOLD_DAYS=7

# ===================================================================
# Zabbix Integration (API Token Authentication)
# ===================================================================
# Zabbix API URL - must point to the JSON-RPC API endpoint
# Format: http://<zabbix-host>/api_jsonrpc.php
# Examples:
#   http://zabbix.example.com/api_jsonrpc.php
#   https://zabbix.example.com/zabbix/api_jsonrpc.php
# Required if GRAFANA_INSTALL_ZABBIX_PLUGIN=true
ZABBIX_URL=http://zabbix.example.com/api_jsonrpc.php

# Zabbix API Token (REQUIRED if Zabbix plugin enabled)
# API token authentication is the only supported method
# Username/password authentication is NOT supported
#
# To generate an API token:
# 1. Login to Zabbix web interface as admin
# 2. Navigate to: Administration â†’ Users
# 3. Select the user for Grafana integration (or create new user)
# 4. Go to "API tokens" tab
# 5. Click "Create API token"
# 6. Set description (e.g., "Grafana Integration")
# 7. Set expiration (optional, or leave empty for no expiration)
# 8. Copy the generated token and paste below
#
# IMPORTANT: Token must have read permissions on required host groups
# Required if GRAFANA_INSTALL_ZABBIX_PLUGIN=true
ZABBIX_API_TOKEN=changeme_zabbix_api_token

# ===================================================================
# Optional: Zabbix Direct Database Access
# ===================================================================
# These variables enable optional direct MySQL access to Zabbix historical data
# This datasource is COMMENTED OUT by default in datasources.yaml
# Uncomment these variables AND the Zabbix-DB datasource if needed
#
# ZABBIX_DB_HOST=zabbix-db.example.com
# ZABBIX_DB_NAME=zabbix
# ZABBIX_DB_USER=grafana_reader
# ZABBIX_DB_PASSWORD=changeme_zabbix_db_password

# ===================================================================
# Firewall Configuration
# ===================================================================
# Configure firewall rules during installation
# Set to 'true' to automatically configure firewall rules
# Set to 'false' to skip firewall configuration (manual setup required)
CONFIGURE_FIREWALL=true

# Admin subnet allowed to access Grafana UI (port 3000)
# Examples: 10.1.10.0/24, 192.168.1.0/24, or single IP: 10.1.10.50/32
# Required if CONFIGURE_FIREWALL=true
GRAFANA_ADMIN_SUBNET=10.1.10.0/24

# LibreNMS VM IP address (allowed to push metrics to InfluxDB port 8086)
# Must be a single IP address (will be converted to /32 automatically)
# Example: 10.2.2.100
# Required if CONFIGURE_FIREWALL=true
LIBRENMS_VM_IP=10.1.10.50

# ===================================================================
# Security Notes
# ===================================================================
# 1. Change ALL default passwords and tokens before deployment
# 2. Use strong, randomly generated passwords (minimum 16 characters)
# 3. Generate InfluxDB token with: openssl rand -base64 32
# 4. Generate Zabbix API token in Zabbix UI (see instructions above)
# 5. Keep this file secure (chmod 600 .env)
# 6. Never commit .env to version control
# 7. Rotate credentials and tokens regularly
# 8. Validate .env completeness: diff .env .env.example

# ===================================================================
# Example Strong Password Generation
# ===================================================================
# openssl rand -base64 24  # Generates a 24-character password
# pwgen -s 32 1            # Generates a 32-character secure password
